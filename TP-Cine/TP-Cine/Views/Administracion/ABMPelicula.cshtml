@using TP_Cine.Models;
@model VerEditarCrearPeliculaModelo

@{Html.RenderPartial("_AdministracionPartial");}

<h1 class="text-center">Administración: Película</h1>

<!--<form method="post" action="/Administracion/AgregarEditarPelicula">-->
<div class="container-fluid">
    <div class="row-fluid">
        <div class="col-md-offset-3 col-md-6">
            @if (Model.accion == "ver")
            {
                <h3>Detalle Película</h3>
            }

            @if (Model.accion == "editar")
            {
                <h3>Modificar Pelicula</h3>
            }
            
            @if (Model.accion == "agregar")
            {
                <h3>Agregar Pelicula</h3>
            }

            <form class="form-horizontal">
                @using (Html.BeginForm("AgregarEditarPelicula", "Administracion", FormMethod.Post, new { enctype = "multipart/form-data" })) {
                    <div class="modal-body">
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        @if (Model.accion != "agregar")
                        {
                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.IdPelicula, "Id", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @Html.TextBoxFor(m => m.pelicula.IdPelicula, new { @class = "form-control", @placeholder = "id", @readonly = "readonly" })
                            </div>                            
                        </div>
                        }

                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.Nombre, "Nombre", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @if (Model.accion != "ver")
                                {
                                    @Html.TextBoxFor(m => m.pelicula.Nombre, new { @class = "form-control", @placeholder = "nombre" })
                                }
                                else{
                                    @Html.TextBoxFor(m => m.pelicula.Nombre, new { @class = "form-control", @placeholder = "nombre", @readonly = "readonly" })
                                }
                                @Html.ValidationMessageFor(m => m.pelicula.Nombre, "", new { @class = "text-danger" })
                            </div>                            
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.Descripcion, "Descripcion", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @if (Model.accion != "ver")
                                {
                                    @Html.TextBoxFor(m => m.pelicula.Descripcion, new { @class = "form-control", @placeholder = "descripcion" })
                                }
                                else
                                {
                                    @Html.TextBoxFor(m => m.pelicula.Descripcion, new { @class = "form-control", @placeholder = "descripcion", @readonly = "readonly" })
                                }
                                @Html.ValidationMessageFor(m => m.pelicula.Descripcion, "", new { @class = "text-danger" })
                            </div>                            
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.Generos, "Generos", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                <select id="Generos" name="Generos" class="form-control" @Html.Raw(Model.accion != "ver" ? "" : "disabled='disabled'")>
                                    @foreach (var genero in Model.lista_generos)
                                    {
                                        if (genero.IdGenero == Model.pelicula.IdGenero)
                                        {
                                            <option value="@genero.IdGenero" selected="selected">@genero.Nombre</option>
                                        }
                                        else
                                        {
                                            <option value="@genero.IdGenero">@genero.Nombre</option>
                                        }
                                    }
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.Calificaciones, "Calificacion", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                <select id="Calificaciones" name="Calificaciones" class="form-control" @Html.Raw(Model.accion != "ver" ? "" : "disabled='disabled'")>
                                    @foreach (var calificacion in Model.lista_calificaciones)
                                        {
                                            if (calificacion.IdCalificacion == Model.pelicula.IdCalificacion)
                                            {
                                            <option value="@calificacion.IdCalificacion" selected="selected">@calificacion.Nombre</option>
                                        }
                                        else
                                        {
                                            <option value="@calificacion.IdCalificacion">@calificacion.Nombre</option>
                                        }
                                    }
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.Imagen, "Imagen", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @if (!string.IsNullOrEmpty(Model.pelicula.Imagen))
                                {
                                    <img src="@Model.pelicula.Imagen" height="150" width="150" class="img-responsive" alt="@Model.pelicula.Nombre" />
                                }
                                @if (Model.accion != "ver")
                                {
                                    @Html.TextBoxFor(m => m.pelicula.Imagen, new { type = "file", @onchange = "previewFile();",@Value = Model.pelicula.Imagen })
                                    @Html.ValidationMessageFor(m => m.pelicula.Imagen, "", new { @class = "text-danger" })
                                }
                            </div>
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.pelicula.Duracion, "Duracion", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @if (Model.accion != "ver")
                                {
                                    @Html.TextBoxFor(m => m.pelicula.Duracion, new { @class = "form-control", @placeholder = "duracion" })
                                }
                                else
                                {
                                    @Html.TextBoxFor(m => m.pelicula.Duracion, new { @class = "form-control", @placeholder = "duracion", @readonly = "readonly" })
                                }
                                @Html.ValidationMessageFor(m => m.pelicula.Duracion, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            @if (Model.accion != "agregar")
                                {                                        
                                    @Html.LabelFor(m => m.pelicula.FechaCarga, "Carga", new { @class = "col-md-2 control-label" })
                                    <div class="col-md-10">    
                                        @Html.TextBoxFor(m => m.pelicula.FechaCarga, new { @class = "form-control", @placeholder = "id", @readonly = "readonly" })
                                    </div>
                                }
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        @if (Model.accion != "ver")
                        {
                            <button id="agregar" type="submit" class="btn btn-default btn-lg">@Html.Raw(Model.accion == "editar" ? "Editar" : "Crear")</button>
                        }
                    </div>
                    <input type="hidden" value="@Model.accion" id="accion" name="accion" />
                }
            </form>
        </div>
    </div>
</div>

<!--</form>-->

<script src="~/js/jquery.min.js"></script>
<!--<script src="~/js/jquery.validate.min.js"></script>
<script src="~/js/jquery.validate.unobtrusive.min.js"></script>-->
<!--include jQuery Validation Plugin-->
<script src="~/js/jquery.validate.min.js"
        type="text/javascript"></script>   
<script src="~/js/jquery.validate.unobtrusive.min.js" type="text/javascript"></script>